<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ocean Katakana Game</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
:root {
    --ocean-deep: #0B4D6A;
    --ocean-medium: #1E6091;
    --ocean-light: #2E86AB;
    --turquoise-dark: #00A896;
    --turquoise-bright: #02C39A;
    --turquoise-light: #7FEFFF;
    --seafoam: #B8F2FF;
    --pearl-white: #F8FDFF;
    --gold: #FFD700;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background: linear-gradient(135deg, var(--ocean-deep) 0%, var(--ocean-medium) 50%, var(--turquoise-dark) 100%);
    background-attachment: fixed;
    color: var(--pearl-white);
    font-family: 'Orbitron', 'Noto Sans JP', sans-serif;
    min-height: 100vh;
    padding: 20px;
}

.game-header {
    text-align: center;
    margin-bottom: 30px;
}

.game-title {
    font-size: 2.5em;
    font-weight: 700;
    color: var(--turquoise-bright);
    margin-bottom: 10px;
}

.game-subtitle {
    font-size: 1.2em;
    color: var(--seafoam);
}

/* Controls */
.controls-section {
    display: flex;
    justify-content: center;
    margin-bottom: 30px;
}

.button-container {
    display: flex;
    gap: 15px;
}

button {
    padding: 12px 25px;
    font-size: 1.1em;
    font-weight: 600;
    background: linear-gradient(135deg, var(--turquoise-dark), var(--turquoise-bright));
    color: var(--pearl-white);
    border: none;
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
    box-shadow: 0 5px 15px rgba(0, 168, 150, 0.4);
}

button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 168, 150, 0.6);
}

#pauseBtn {
    background: linear-gradient(135deg, #FF6B9D, #FF8B9D);
}

#restartBtn {
    background: linear-gradient(135deg, var(--gold), #FFA500);
    color: var(--ocean-deep);
}

/* Main game layout */
.game-main {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 40px;
    max-width: 1000px;
    margin: 0 auto;
}

.game-area {
    display: flex;
    flex-direction: column;
    align-items: center;
}

canvas {
    background: radial-gradient(circle at center, #001122 0%, #000511 100%);
    border: 4px solid var(--turquoise-bright);
    border-radius: 15px;
    box-shadow: 0 0 30px rgba(2, 195, 154, 0.5);
}

/* Input section */
.input-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 600px;
    background: rgba(11, 77, 106, 0.3);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    border: 2px solid rgba(127, 239, 255, 0.3);
    padding: 30px;
    min-width: 300px;
}

#score {
    font-size: 1.8em;
    font-weight: 700;
    color: var(--gold);
    background: rgba(11, 77, 106, 0.8);
    padding: 15px 30px;
    border-radius: 15px;
    border: 3px solid var(--gold);
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
    text-shadow: 0 0 10px var(--gold);
    margin-bottom: 25px;
}

.input-label {
    color: var(--turquoise-bright);
    font-size: 1.3em;
    font-weight: 600;
    margin-bottom: 20px;
    text-align: center;
}

#inputBox {
    font-size: 1.2em;
    padding: 15px 25px;
    width: 100%;
    max-width: 280px;
    text-align: center;
    border: 2px solid var(--turquoise-bright);
    border-radius: 15px;
    outline: none;
    background: rgba(30, 96, 145, 0.8);
    color: var(--pearl-white);
    font-family: 'Noto Sans JP', sans-serif;
    font-weight: 600;
    transition: all 0.3s ease;
}

#inputBox:focus {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(127, 239, 255, 0.4);
    background: rgba(46, 134, 171, 0.9);
}

#inputBox::placeholder {
    color: rgba(248, 253, 255, 0.6);
}

.input-help {
    color: var(--seafoam);
    font-size: 0.9em;
    margin-top: 15px;
    text-align: center;
    opacity: 0.8;
}

/* Responsive */
@media (max-width: 768px) {
    .game-main {
        flex-direction: column;
        align-items: center;
        gap: 30px;
    }
    
    .input-section {
        min-height: auto;
        padding: 25px;
        min-width: 280px;
    }
    
    canvas {
        width: 350px !important;
        height: 525px !important;
    }
    
    .game-title {
        font-size: 2em;
    }
    
    button {
        padding: 10px 20px;
        font-size: 1em;
    }
}

@media (max-width: 480px) {
    .game-title {
        font-size: 1.6em;
    }
    
    canvas {
        width: 300px !important;
        height: 450px !important;
    }
    
    .button-container {
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
    }
    
    #inputBox {
        width: 250px;
    }
}

/* Popup styles */
.popup-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(11, 77, 106, 0.9);
    backdrop-filter: blur(8px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

.popup-content {
    background: linear-gradient(135deg, rgba(11, 77, 106, 0.95), rgba(30, 96, 145, 0.9));
    backdrop-filter: blur(20px);
    padding: 40px;
    border-radius: 20px;
    border: 3px solid var(--turquoise-bright);
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
    max-width: 500px;
    width: 90%;
    text-align: center;
}

.popup-title {
    font-size: 2em;
    color: var(--turquoise-bright);
    margin-bottom: 20px;
}

.popup-instructions {
    color: var(--seafoam);
    font-size: 1.1em;
    line-height: 1.6;
    margin-bottom: 30px;
}

.popup-close-btn {
    background: linear-gradient(135deg, var(--turquoise-dark), var(--turquoise-bright));
    color: var(--pearl-white);
    border: none;
    padding: 15px 30px;
    font-size: 1.2em;
    font-weight: 600;
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.popup-close-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 168, 150, 0.6);
}

.popup-overlay.hidden {
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}
</style>
</head>
<body>

<!-- How to Play Popup -->
<div class="popup-overlay" id="howToPlayPopup">
    <div class="popup-content">
        <h2 class="popup-title">How to Play</h2>
        <div class="popup-instructions">
            <p><strong>Goal:</strong> Type the romaji (English pronunciation) of falling katakana characters</p>
            <p><strong>Controls:</strong> Type answer and press Enter</p>
            <p><strong>Scoring:</strong> +10 points for correct, -5 for missed</p>
            <p>Ready to master katakana?</p>
        </div>
        <button class="popup-close-btn" onclick="closeHowToPlay()">
            <i class="fas fa-play"></i> Start Playing!
        </button>
    </div>
</div>

<div class="game-header">
    <h1 class="game-title">
        <i class="fas fa-water"></i> OCEAN KATAKANA ADVENTURE
    </h1>
    <p class="game-subtitle">Master Japanese katakana characters</p>
</div>

<div class="controls-section">
    <div class="button-container">
        <button id="playBtn"><i class="fas fa-play"></i> Play</button>
        <button id="pauseBtn"><i class="fas fa-pause"></i> Pause</button>
        <button id="restartBtn"><i class="fas fa-redo"></i> Restart</button>
    </div>
</div>

<div class="game-main">
    <div class="game-area">
        <canvas id="gameCanvas" width="400" height="600"></canvas>
    </div>
    
    <div class="input-section">
        <div id="score">Score: 0</div>
        <div class="input-label">
            <i class="fas fa-keyboard"></i> Type Romaji Here
        </div>
        <input type="text" id="inputBox" placeholder="e.g., ka, shi, tsu..." autofocus>
        <div class="input-help">
            Watch the falling katakana and type their pronunciation!
        </div>
    </div>
</div>

<script>
// Popup functionality
function closeHowToPlay() {
    const popup = document.getElementById('howToPlayPopup');
    popup.classList.add('hidden');
    setTimeout(() => {
        popup.style.display = 'none';
    }, 300);
}

// Original game logic
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const inputBox = document.getElementById('inputBox');
const playBtn = document.getElementById('playBtn');
const pauseBtn = document.getElementById('pauseBtn');
const restartBtn = document.getElementById('restartBtn');

const katakanaList = [
  { kana: 'ア', romaji: 'a' }, { kana: 'イ', romaji: 'i' }, { kana: 'ウ', romaji: 'u' },
  { kana: 'エ', romaji: 'e' }, { kana: 'オ', romaji: 'o' },
  { kana: 'カ', romaji: 'ka' }, { kana: 'キ', romaji: 'ki' }, { kana: 'ク', romaji: 'ku' },
  { kana: 'ケ', romaji: 'ke' }, { kana: 'コ', romaji: 'ko' },
  { kana: 'サ', romaji: 'sa' }, { kana: 'シ', romaji: 'shi' }, { kana: 'ス', romaji: 'su' },
  { kana: 'セ', romaji: 'se' }, { kana: 'ソ', romaji: 'so' },
  { kana: 'タ', romaji: 'ta' }, { kana: 'チ', romaji: 'chi' }, { kana: 'ツ', romaji: 'tsu' },
  { kana: 'テ', romaji: 'te' }, { kana: 'ト', romaji: 'to' },
  { kana: 'ナ', romaji: 'na' }, { kana: 'ニ', romaji: 'ni' }, { kana: 'ヌ', romaji: 'nu' },
  { kana: 'ネ', romaji: 'ne' }, { kana: 'ノ', romaji: 'no' },
  { kana: 'ハ', romaji: 'ha' }, { kana: 'ヒ', romaji: 'hi' }, { kana: 'フ', romaji: 'fu' },
  { kana: 'ヘ', romaji: 'he' }, { kana: 'ホ', romaji: 'ho' },
  { kana: 'マ', romaji: 'ma' }, { kana: 'ミ', romaji: 'mi' }, { kana: 'ム', romaji: 'mu' },
  { kana: 'メ', romaji: 'me' }, { kana: 'モ', romaji: 'mo' },
  { kana: 'ヤ', romaji: 'ya' }, { kana: 'ユ', romaji: 'yu' }, { kana: 'ヨ', romaji: 'yo' },
  { kana: 'ラ', romaji: 'ra' }, { kana: 'リ', romaji: 'ri' }, { kana: 'ル', romaji: 'ru' },
  { kana: 'レ', romaji: 're' }, { kana: 'ロ', romaji: 'ro' },
  { kana: 'ワ', romaji: 'wa' }, { kana: 'ヲ', romaji: 'wo' }, { kana: 'ン', romaji: 'n' },
  { kana: 'ガ', romaji: 'ga' }, { kana: 'ギ', romaji: 'gi' }, { kana: 'グ', romaji: 'gu' },
  { kana: 'ゲ', romaji: 'ge' }, { kana: 'ゴ', romaji: 'go' },
  { kana: 'ザ', romaji: 'za' }, { kana: 'ジ', romaji: 'ji' }, { kana: 'ズ', romaji: 'zu' },
  { kana: 'ゼ', romaji: 'ze' }, { kana: 'ゾ', romaji: 'zo' },
  { kana: 'ダ', romaji: 'da' }, { kana: 'ヂ', romaji: 'ji' }, { kana: 'ヅ', romaji: 'zu' },
  { kana: 'デ', romaji: 'de' }, { kana: 'ド', romaji: 'do' },
  { kana: 'バ', romaji: 'ba' }, { kana: 'ビ', romaji: 'bi' }, { kana: 'ブ', romaji: 'bu' },
  { kana: 'ベ', romaji: 'be' }, { kana: 'ボ', romaji: 'bo' },
  { kana: 'パ', romaji: 'pa' }, { kana: 'ピ', romaji: 'pi' }, { kana: 'プ', romaji: 'pu' },
  { kana: 'ペ', romaji: 'pe' }, { kana: 'ポ', romaji: 'po' },
  { kana: 'キャ', romaji: 'kya' }, { kana: 'キュ', romaji: 'kyu' }, { kana: 'キョ', romaji: 'kyo' },
  { kana: 'シャ', romaji: 'sha' }, { kana: 'シュ', romaji: 'shu' }, { kana: 'ショ', romaji: 'sho' },
  { kana: 'チャ', romaji: 'cha' }, { kana: 'チュ', romaji: 'chu' }, { kana: 'チョ', romaji: 'cho' },
  { kana: 'ニャ', romaji: 'nya' }, { kana: 'ニュ', romaji: 'nyu' }, { kana: 'ニョ', romaji: 'nyo' },
  { kana: 'ヒャ', romaji: 'hya' }, { kana: 'ヒュ', romaji: 'hyu' }, { kana: 'ヒョ', romaji: 'hyo' },
  { kana: 'ミャ', romaji: 'mya' }, { kana: 'ミュ', romaji: 'myu' }, { kana: 'ミョ', romaji: 'myo' },
  { kana: 'リャ', romaji: 'rya' }, { kana: 'リュ', romaji: 'ryu' }, { kana: 'リョ', romaji: 'ryo' }
];

let fallingKana = [];
let score = 0;
let isPaused = true;
let spawnInterval;
let animationId;

class Kana {
    constructor(kanaObj) {
        this.kana = kanaObj.kana;
        this.romaji = kanaObj.romaji;
        this.x = Math.random() * (canvas.width - 40);
        this.y = 0;
        this.speed = 1 + Math.random() * 2;
        this.color = `hsl(${Math.random()*360}, 100%, 70%)`;
    }
    draw() {
        ctx.fillStyle = this.color;
        ctx.font = '40px Noto Sans JP';
        ctx.shadowColor = '#7FEFFF';
        ctx.shadowBlur = 15;
        ctx.fillText(this.kana, this.x, this.y);
        ctx.shadowBlur = 0;
    }
    update() {
        this.y += this.speed;
    }
}

function spawnKana() {
    const randomKana = katakanaList[Math.floor(Math.random() * katakanaList.length)];
    fallingKana.push(new Kana(randomKana));
}

function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (let i = 0; i < fallingKana.length; i++) {
        fallingKana[i].update();
        fallingKana[i].draw();
        if (fallingKana[i].y > canvas.height) {
            fallingKana.splice(i, 1);
            score -= 5;
            document.getElementById('score').innerText = "Score: " + score;
            i--;
        }
    }
    if (!isPaused) animationId = requestAnimationFrame(gameLoop);
}

inputBox.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
        const typedInput = inputBox.value.toLowerCase();
        for (let i = 0; i < fallingKana.length; i++) {
            if (typedInput === fallingKana[i].romaji) {
                fallingKana.splice(i, 1);
                score += 10;
                document.getElementById('score').innerText = "Score: " + score;
                break;
            }
        }
        inputBox.value = '';
    }
});

playBtn.addEventListener('click', () => {
    if (isPaused) {
        isPaused = false;
        spawnInterval = setInterval(spawnKana, 1200);
        gameLoop();
    }
});

pauseBtn.addEventListener('click', () => {
    isPaused = true;
    clearInterval(spawnInterval);
    cancelAnimationFrame(animationId);
});

restartBtn.addEventListener('click', () => {
    fallingKana = [];
    score = 0;
    document.getElementById('score').innerText = "Score: " + score;
    isPaused = false;
    clearInterval(spawnInterval);
    cancelAnimationFrame(animationId);
    spawnInterval = setInterval(spawnKana, 1200);
    gameLoop();
});
</script>

</body>
</html>